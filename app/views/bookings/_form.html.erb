<% noun = @course.course? ? 'Course' : 'Class' %>
<%= f.error_notification %>

<%# if @course.spaces_left? %>
  <%# f.input :guests, :type => :select, collection: @course.guest_values, :label => 'Bring a friend! (or two)', :selected => 0, wrapper: :horizontal  %>
  <div class="hidden">
    <%# f.input :bookings, :label => 'Friend 1', wrapper: :horizontal, :input_html => { value: ""} %>
  </div>
  <div id="friend_pen">
  </div>
<%# end %>

<%= f.input :course_id, :as => :hidden, :input_html => { :value => @course.id } %>
<div class="center">
  <div class="col-xs-12">
      <span class="light"> 
        The <span class="strong em"><%= noun %></span> will run 
      </span>
      <ul>
        <% @course.classes.each do |lesson| %>
          <li class="strong em x1-25">
            <%= day_ordinal_month(lesson.start_at, true, false) %>,
            <%= pretty_time_range(lesson.start_at, lesson.end_at) %>
          </li>
        <% end %>
      </ul>
  </div>
  <br />
  <div class="col-xs-12 light">
    <% if @course.cost? && @course.cost > 0 %>
      The cost to attend is <span class="x1-25">$<%= @course.cost_formatted %></span>
    <% else %>
      This <%= noun %> is <strong>free to attend</strong>  
    <% end %>
  </div>
  <br />
  <div class="col-xs-12 light">
    <br />
    The <%= noun %> is provided by <strong><%= @course.channel.name %></strong>
  </div>

  <% if @course.address.present? %>
    <div class="row">
    <br /><br />
      <div class="col-sm-6">
        <input type="hidden" id="longitude" value="<%= @course.longitude %>" />
        <input type="hidden" id="latitude" value="<%= @course.latitude %>" />
        
        <div id="map-canvas"></div>
        <div class="text-right">
        </div>
      </div>
      <div class="col-sm-6 text-left">
        <div class="col-sm-5 text-right">
          <span class="light">Taught by</span>
        </div>
        <div class="col-sm-7">
          <span id="summary_teacher_id"><%= @course.teacher.name %></span>
        </div>
        <br />
        <br />
        <div class="col-sm-5 text-right">
          <span class="light">at</span>
        </div>
        <div class="col-sm-7">
          <p id="summary_venue_address" class="light grey">
            <%= @course.address %>
          </p>
        </div>
        <div class="col-sm-5 text-right">
          <span class="light">Details</span>
        </div>
        <div class="col-sm-7">
          <p id="summary_venue" class="light grey">
            <%= @course.venue %>
          </p>
        </div>
      </div>
    </div>
  <% else %>
    <p class="light">
      <em>at</em> <br />
      <strong> <%= @course.venue %> </strong>
    </p>
  <% end %>
  
  <div class="col-md-3 hidden-xs">
  </div>
  <div class="col-md-6 col-xs-12 center">
    <br />
    <div class="text-left">
      <%= f.input :name, label: '<span class="small light grey">Attendee Name</small>' %>
      <%= f.input :note_to_teacher, as: :text, label: '<span class="small light grey">Note to Teacher</small>' %>
      <% if @course.custom_fields %>
        <% @course.custom_fields.each do |field| %>
          <%= f.input :custom_fields, 
              input_html: { name: "custom_fields[#{field[:prompt]}]"+(field[:type]=='check_boxes' ? '[]' : ''), 
              value: (params[:custom_fields].is_a?(Hash) ? params[:custom_fields][field[:prompt]] : '') }, 
              as: field[:type], 
              label: field[:prompt], 
              collection: field[:options], 
              checked: (params[:custom_fields].is_a?(Hash) ? params[:custom_fields][field[:prompt]] : '') %>
        <% end %>
        
      <% end %>
    </div>
    <% if policy(@course).admin? && @course.paid? %>
      <br/><br />
      <div class="alert-danger alert clearfix">
        <div class="light small col-xs-6">
          Admin options
        </div>
        <div class="checkbox col-xs-6">
          <label id="wavefees">
            <input type="checkbox" id="wavefees" name="remove_fees" value="1" />
            <span style="position:relative; bottom:10px;">Waive fees</span>
          </label>
        </div>
      </div>
    <% end %>
    <br /><br />
    <% if f.object.new_record? %>
      <div class="checkbox center">
        <label id="teaching_agreeterms" data-error-message="You must agree to the terms and conditions to continue">
          <input type="checkbox" id="booking_terms_and_conditions" value="1" />
          <span style="position:relative; bottom:10px;"> I agree to the <a data-toggle="modal" href="#termsModal">Terms and Conditions</a></span>
        </label>
      </div>
    <% end %>
    <input type="submit" value="Book the <%= noun %>" class="btn btn-primary col-xs-12" />
  </div>
  <div class="col-md-3 hidden-xs">
  </div>

</div>
